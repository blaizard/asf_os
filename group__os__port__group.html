<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>OS: Porting functions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">OS</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Porting functions</div>  </div>
<div class="ingroups"><a class="el" href="group__group__os.html">eeOS</a></div></div>
<div class="contents">

<p>Functions which should be implemented to port this operating system onto another platform.  
<a href="#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for Porting functions:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__os__port__group.gif" border="0" alt="" usemap="#group____os____port____group"/>
<map name="group____os____port____group" id="group____os____port____group">
</map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__os__port__group.html#gae36200d59d62e81114d9330a2cab31c5">os_switch_context</a>(bypass_context_saving)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Context switch for a process.<br/>
 Function used to schedule and switch between the processes.<br/>
 This function will handle the return from a softwre interrupt. Therefore it can be optimized to bypass the saving context part IF an interrupt is running.  <a href="#gae36200d59d62e81114d9330a2cab31c5"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__os__port__group.html#ga8c5be06e8a791ac257e372d19a41e527">os_enter_critical</a> (void)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Start of a critical code region. Preemptive context switches cannot occur when in a critical region.<br/>
.  <a href="#ga8c5be06e8a791ac257e372d19a41e527"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__os__port__group.html#ga5ec2153c49756d277aa7b4a84708173e">os_free</a> (<a class="el" href="os__port_8h.html#a0c6bdb0cfe9a04a4942b875a52958fc9">os_ptr_t</a> ptr)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Free memory previously allocated by <a class="el" href="group__os__port__group.html#ga7490a7a8211d044d1cf3cb7fe91ef8ca">os_malloc</a>.  <a href="#ga5ec2153c49756d277aa7b4a84708173e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__os__port__group.html#ga1ed5e871f1b9707aafedd8f97d9d6524">os_leave_critical</a> (void)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Exit a critical code region.<br/>
.  <a href="#ga1ed5e871f1b9707aafedd8f97d9d6524"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="os__port_8h.html#a0c6bdb0cfe9a04a4942b875a52958fc9">os_ptr_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__os__port__group.html#ga7490a7a8211d044d1cf3cb7fe91ef8ca">os_malloc</a> (int stack_size)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate some memory for the stack of a task.  <a href="#ga7490a7a8211d044d1cf3cb7fe91ef8ca"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="compiler_8h.html#a97a80ca1602ebf2303258971a2c938e2">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__os__port__group.html#ga61a509098660222d7a1853c1c4646528">os_process_context_load</a> (struct <a class="el" href="structos__process.html">os_process</a> *proc, <a class="el" href="os__core_8h.html#aa8898862af2024b1bdd152cc0be2da2f">os_proc_ptr_t</a> proc_ptr, <a class="el" href="os__port_8h.html#a0c6bdb0cfe9a04a4942b875a52958fc9">os_ptr_t</a> args)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Load the context of a task into the stack. this is the inital process which will setup the stack before entering in the task function.  <a href="#ga61a509098660222d7a1853c1c4646528"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__os__port__group.html#ga3950e19158970000b838014a821fa8d8">os_setup_scheduler</a> (uint32_t ref_hz)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup the task scheduler interrupt.  <a href="#ga3950e19158970000b838014a821fa8d8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structos__process.html">os_process</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__os__port__group.html#gab74d8096f9ac6e91cac465212f953f5f">os_switch_context_hook</a> (void)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">This function must be called inside the <a class="el" href="group__os__port__group.html#gae36200d59d62e81114d9330a2cab31c5">os_switch_context</a> function in order to switch process context.  <a href="#gab74d8096f9ac6e91cac465212f953f5f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__os__port__group.html#ga190ac35a6514e5abd07f888ac794e541">os_switch_context_int_handler</a> (void)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Context switch for a process.<br/>
 Interrupt handler which is used to schedule and switch between the processes.  <a href="#ga190ac35a6514e5abd07f888ac794e541"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structos__process.html">os_process</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__os__port__group.html#gace899bdd3da9a10327e10f93ec79c49a">os_switch_context_int_handler_hook</a> (void)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">This function must be called inside the <a class="el" href="group__os__port__group.html#ga190ac35a6514e5abd07f888ac794e541">os_switch_context_int_handler</a> function in order to switch task context.  <a href="#gace899bdd3da9a10327e10f93ec79c49a"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<p>Functions which should be implemented to port this operating system onto another platform. </p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="gae36200d59d62e81114d9330a2cab31c5"></a><!-- doxytag: member="os_port.h::os_switch_context" ref="gae36200d59d62e81114d9330a2cab31c5" args="(bypass_context_saving)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">os_switch_context</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">bypass_context_saving</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment"><span class="keywordflow">do</span> { \
        __asm__ __volatile__ ( \
            <span class="stringliteral">&quot;mov r8, &quot;</span><a class="code" href="group__group__avr32__utils__stringz.html#ga612b641ada5f31dd0cb1c036b308d242" title="Absolute stringize.">ASTRINGZ</a>(bypass_context_saving)<span class="stringliteral">&quot;\n\t&quot;</span> \
            <span class="stringliteral">&quot;scall\n\t&quot;</span> \
        ); \
    } <span class="keywordflow">while</span> (<span class="keyword">false</span>)
</pre></div>
<p>Context switch for a process.<br/>
 Function used to schedule and switch between the processes.<br/>
 This function will handle the return from a softwre interrupt. Therefore it can be optimized to bypass the saving context part IF an interrupt is running. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">bypass_context_saving</td><td>If true, this function needs to bypass the context saving. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="os__port_8h_source.html#l00073">73</a> of file <a class="el" href="os__port_8h_source.html">os_port.h</a>.</p>

<p>Referenced by <a class="el" href="os__interrupt_8c_source.html#l00019">__os_interrupt_handler()</a>, <a class="el" href="os__core_8c_source.html#l00155">os_process_disable()</a>, <a class="el" href="os__event_8c_source.html#l00258">os_task_sleep()</a>, and <a class="el" href="os__core_8c_source.html#l00167">os_yield()</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ga8c5be06e8a791ac257e372d19a41e527"></a><!-- doxytag: member="os_port.h::os_enter_critical" ref="ga8c5be06e8a791ac257e372d19a41e527" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">os_enter_critical </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Start of a critical code region. Preemptive context switches cannot occur when in a critical region.<br/>
. </p>

<p>Definition at line <a class="el" href="os__port_8h_source.html#l00065">65</a> of file <a class="el" href="os__port_8h_source.html">os_port.h</a>.</p>

<p>References <a class="el" href="interrupt__avr32_8h_source.html#l00170">cpu_irq_disable</a>.</p>

<p>Referenced by <a class="el" href="os__mutex_8c_source.html#l00030">__os_event_mutex_is_triggered()</a>, <a class="el" href="os__interrupt_8c_source.html#l00019">__os_interrupt_handler()</a>, <a class="el" href="os__event_8c_source.html#l00166">os_event_scheduler()</a>, <a class="el" href="os__semaphore_8c_source.html#l00036">os_event_sempahore_is_triggered()</a>, <a class="el" href="os__event_8c_source.html#l00248">os_interrupt_trigger_on_event()</a>, <a class="el" href="os__mutex_8c_source.html#l00047">os_mutex_lock()</a>, <a class="el" href="os__mutex_8c_source.html#l00067">os_mutex_unlock()</a>, <a class="el" href="os__core_8c_source.html#l00155">os_process_disable()</a>, <a class="el" href="os__core_8c_source.html#l00108">os_process_enable()</a>, <a class="el" href="os__semaphore_8c_source.html#l00075">os_semaphore_release()</a>, <a class="el" href="os__semaphore_8c_source.html#l00056">os_semaphore_take()</a>, <a class="el" href="os__event_8c_source.html#l00258">os_task_sleep()</a>, and <a class="el" href="os__core_8c_source.html#l00167">os_yield()</a>.</p>
<div class="fragment"><pre class="fragment">                                           {
    <a class="code" href="group__interrupt__group.html#ga7b77391ed86e2e027f9ee1dd99a06980" title="Disable interrupts globally.">cpu_irq_disable</a>();
};
</pre></div>
</div>
</div>
<a class="anchor" id="ga5ec2153c49756d277aa7b4a84708173e"></a><!-- doxytag: member="os_core.h::os_free" ref="ga5ec2153c49756d277aa7b4a84708173e" args="(os_ptr_t ptr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void os_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="os__port_8h.html#a0c6bdb0cfe9a04a4942b875a52958fc9">os_ptr_t</a>&#160;</td>
          <td class="paramname"><em>ptr</em></td><td>)</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Free memory previously allocated by <a class="el" href="group__os__port__group.html#ga7490a7a8211d044d1cf3cb7fe91ef8ca">os_malloc</a>. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ptr</td><td>The memory to free </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="os__core_8h_source.html#l00572">572</a> of file <a class="el" href="os__core_8h_source.html">os_core.h</a>.</p>

<p>Referenced by <a class="el" href="os__task_8h_source.html#l00108">os_task_delete()</a>.</p>
<div class="fragment"><pre class="fragment">                                         {
    free((<span class="keywordtype">void</span> *) ptr);
}
</pre></div>
</div>
</div>
<a class="anchor" id="ga1ed5e871f1b9707aafedd8f97d9d6524"></a><!-- doxytag: member="os_port.h::os_leave_critical" ref="ga1ed5e871f1b9707aafedd8f97d9d6524" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">os_leave_critical </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Exit a critical code region.<br/>
. </p>

<p>Definition at line <a class="el" href="os__port_8h_source.html#l00069">69</a> of file <a class="el" href="os__port_8h_source.html">os_port.h</a>.</p>

<p>References <a class="el" href="interrupt__avr32_8h_source.html#l00165">cpu_irq_enable</a>.</p>

<p>Referenced by <a class="el" href="os__mutex_8c_source.html#l00030">__os_event_mutex_is_triggered()</a>, <a class="el" href="os__event_8c_source.html#l00166">os_event_scheduler()</a>, <a class="el" href="os__semaphore_8c_source.html#l00036">os_event_sempahore_is_triggered()</a>, <a class="el" href="os__event_8c_source.html#l00248">os_interrupt_trigger_on_event()</a>, <a class="el" href="os__mutex_8c_source.html#l00047">os_mutex_lock()</a>, <a class="el" href="os__mutex_8c_source.html#l00067">os_mutex_unlock()</a>, <a class="el" href="os__core_8c_source.html#l00155">os_process_disable()</a>, <a class="el" href="os__core_8c_source.html#l00108">os_process_enable()</a>, <a class="el" href="os__semaphore_8c_source.html#l00075">os_semaphore_release()</a>, <a class="el" href="os__semaphore_8c_source.html#l00056">os_semaphore_take()</a>, <a class="el" href="os__event_8c_source.html#l00258">os_task_sleep()</a>, and <a class="el" href="os__core_8c_source.html#l00167">os_yield()</a>.</p>
<div class="fragment"><pre class="fragment">                                           {
    <a class="code" href="group__interrupt__group.html#gae4922a4bd8ba4150211fbc7f2302403c" title="Enable interrupts globally.">cpu_irq_enable</a>();
};
</pre></div>
</div>
</div>
<a class="anchor" id="ga7490a7a8211d044d1cf3cb7fe91ef8ca"></a><!-- doxytag: member="os_core.h::os_malloc" ref="ga7490a7a8211d044d1cf3cb7fe91ef8ca" args="(int stack_size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="os__port_8h.html#a0c6bdb0cfe9a04a4942b875a52958fc9">os_ptr_t</a> os_malloc </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>stack_size</em></td><td>)</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Allocate some memory for the stack of a task. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">stack_size</td><td>The size in byte of the stack </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The pointer of the memory allocated, NULL in case of an error. </dd></dl>

<p>Definition at line <a class="el" href="os__core_8h_source.html#l00561">561</a> of file <a class="el" href="os__core_8h_source.html">os_core.h</a>.</p>

<p>Referenced by <a class="el" href="os__task_8c_source.html#l00037">os_task_create()</a>.</p>
<div class="fragment"><pre class="fragment">                                                 {
    <span class="keywordflow">return</span> (<a class="code" href="os__port_8h.html#a0c6bdb0cfe9a04a4942b875a52958fc9">os_ptr_t</a>) malloc(stack_size);
}
</pre></div>
</div>
</div>
<a class="anchor" id="ga61a509098660222d7a1853c1c4646528"></a><!-- doxytag: member="os_core.h::os_process_context_load" ref="ga61a509098660222d7a1853c1c4646528" args="(struct os_process *proc, os_proc_ptr_t proc_ptr, os_ptr_t args)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="compiler_8h.html#a97a80ca1602ebf2303258971a2c938e2">bool</a> os_process_context_load </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structos__process.html">os_process</a> *&#160;</td>
          <td class="paramname"><em>proc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="os__core_8h.html#aa8898862af2024b1bdd152cc0be2da2f">os_proc_ptr_t</a>&#160;</td>
          <td class="paramname"><em>proc_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="os__port_8h.html#a0c6bdb0cfe9a04a4942b875a52958fc9">os_ptr_t</a>&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Load the context of a task into the stack. this is the inital process which will setup the stack before entering in the task function. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">proc</td><td>The task </td></tr>
    <tr><td class="paramname">proc_ptr</td><td>Pointer of the entry point of the process </td></tr>
    <tr><td class="paramname">args</td><td>Parameters to pass to the task </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>true in case of success, false otherwise </dd></dl>

<p>Definition at line <a class="el" href="uc3__port_8c_source.html#l00258">258</a> of file <a class="el" href="uc3__port_8c_source.html">uc3_port.c</a>.</p>

<p>References <a class="el" href="os__port_8h_source.html#l00045">CONFIG_OS_DEFAULT_SR_VALUE</a>, and <a class="el" href="uc3__port_8c_source.html#l00021">PUSH</a>.</p>

<p>Referenced by <a class="el" href="os__task_8c_source.html#l00037">os_task_create()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="uc3__port_8c.html#acee306d364dbcd181acd2216c44ff0f5">PUSH</a>(proc, 0); <span class="comment">// R8</span>
    <a class="code" href="uc3__port_8c.html#acee306d364dbcd181acd2216c44ff0f5">PUSH</a>(proc, 0); <span class="comment">// R9</span>
    <a class="code" href="uc3__port_8c.html#acee306d364dbcd181acd2216c44ff0f5">PUSH</a>(proc, 0); <span class="comment">// R10</span>
    <a class="code" href="uc3__port_8c.html#acee306d364dbcd181acd2216c44ff0f5">PUSH</a>(proc, 0); <span class="comment">// R11</span>
    <a class="code" href="uc3__port_8c.html#acee306d364dbcd181acd2216c44ff0f5">PUSH</a>(proc, args); <span class="comment">// R12</span>
    <a class="code" href="uc3__port_8c.html#acee306d364dbcd181acd2216c44ff0f5">PUSH</a>(proc, 0); <span class="comment">// LR</span>
    <a class="code" href="uc3__port_8c.html#acee306d364dbcd181acd2216c44ff0f5">PUSH</a>(proc, (<span class="keywordtype">void</span> *) proc_ptr); <span class="comment">// PC</span>
    <a class="code" href="uc3__port_8c.html#acee306d364dbcd181acd2216c44ff0f5">PUSH</a>(proc, <a class="code" href="group__group__os__config.html#gabb8340c1f06ae44804fcaea46db5fc75" title="This is the default value assigned to the Status Register (SR) before running a new task...">CONFIG_OS_DEFAULT_SR_VALUE</a>);
    <a class="code" href="uc3__port_8c.html#acee306d364dbcd181acd2216c44ff0f5">PUSH</a>(proc, 0); <span class="comment">// R0</span>
    <a class="code" href="uc3__port_8c.html#acee306d364dbcd181acd2216c44ff0f5">PUSH</a>(proc, 0); <span class="comment">// R1</span>
    <a class="code" href="uc3__port_8c.html#acee306d364dbcd181acd2216c44ff0f5">PUSH</a>(proc, 0); <span class="comment">// R2</span>
    <a class="code" href="uc3__port_8c.html#acee306d364dbcd181acd2216c44ff0f5">PUSH</a>(proc, 0); <span class="comment">// R3</span>
    <a class="code" href="uc3__port_8c.html#acee306d364dbcd181acd2216c44ff0f5">PUSH</a>(proc, 0); <span class="comment">// R4</span>
    <a class="code" href="uc3__port_8c.html#acee306d364dbcd181acd2216c44ff0f5">PUSH</a>(proc, 0); <span class="comment">// R5</span>
    <a class="code" href="uc3__port_8c.html#acee306d364dbcd181acd2216c44ff0f5">PUSH</a>(proc, 0); <span class="comment">// R6</span>
    <a class="code" href="uc3__port_8c.html#acee306d364dbcd181acd2216c44ff0f5">PUSH</a>(proc, 0); <span class="comment">// R7</span>

    <span class="keywordflow">return</span> <span class="keyword">true</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ga3950e19158970000b838014a821fa8d8"></a><!-- doxytag: member="os_core.h::os_setup_scheduler" ref="ga3950e19158970000b838014a821fa8d8" args="(uint32_t ref_hz)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void os_setup_scheduler </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ref_hz</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Setup the task scheduler interrupt. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ref_hz</td><td>The reference frequency used to clock the peripheral which will generate the tick interrupt. Usually this frequency is equal to the CPU frequency. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="uc3__port_8c_source.html#l00037">37</a> of file <a class="el" href="uc3__port_8c_source.html">uc3_port.c</a>.</p>

<p>References <a class="el" href="os__port_8h_source.html#l00053">CONFIG_OS_SCHEDULER_IRQ_PRIORITY</a>, <a class="el" href="os__core_8h_source.html#l00161">CONFIG_OS_TICK_HZ</a>, <a class="el" href="interrupt__avr32_8h_source.html#l00170">cpu_irq_disable</a>, <a class="el" href="interrupt__avr32_8h_source.html#l00165">cpu_irq_enable</a>, <a class="el" href="interrupt__avr32_8h_source.html#l00125">irq_initialize_vectors</a>, <a class="el" href="interrupt__avr32_8h_source.html#l00153">irq_register_handler</a>, <a class="el" href="group__os__port__group.html#ga190ac35a6514e5abd07f888ac794e541">os_switch_context_int_handler()</a>, and <a class="el" href="compiler_8h_source.html#l00186">Set_system_register</a>.</p>

<p>Referenced by <a class="el" href="os__core_8h_source.html#l00393">os_start()</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <a class="code" href="group__interrupt__group.html#ga7b77391ed86e2e027f9ee1dd99a06980" title="Disable interrupts globally.">cpu_irq_disable</a>();
        <a class="code" href="group__interrupt__group.html#ga931b667f6490ad3d8905fa25bebb24b1" title="Initialize interrupt vectors.">irq_initialize_vectors</a>();
        <a class="code" href="group__interrupt__group.html#ga868d7dab733175af137af27093316f8f" title="Register handler for interrupt.">irq_register_handler</a>((<a class="code" href="group__interrupt__group.html#gad5f77ebc8854191fe7bf04c42453e7fa" title="Pointer to interrupt handler.">__int_handler</a>) <a class="code" href="group__os__port__group.html#ga190ac35a6514e5abd07f888ac794e541" title="Context switch for a process.  Interrupt handler which is used to schedule and switch between the pro...">os_switch_context_int_handler</a>,
                AVR32_CORE_COMPARE_IRQ, <a class="code" href="group__group__os__config.html#gaa40e50b01492f3474215258d64938c19" title="IRQ priority of the tick interrupt.">CONFIG_OS_SCHEDULER_IRQ_PRIORITY</a>);
        <a class="code" href="group__group__avr32__utils.html#ga066ae70b5eec2ef5e722943519399604">Set_system_register</a>(AVR32_COMPARE, cpu_freq_hz / <a class="code" href="group__group__os__config.html#ga44dcb5adb4f9a48ee335561cbd703952" title="Set the tick frequency in Hz. This configuration is not used if CONFIG_OS_SCHEDULER_COOPERATIVE is ch...">CONFIG_OS_TICK_HZ</a>);
        <a class="code" href="group__group__avr32__utils.html#ga066ae70b5eec2ef5e722943519399604">Set_system_register</a>(AVR32_COUNT, 0);
        <a class="code" href="group__interrupt__group.html#gae4922a4bd8ba4150211fbc7f2302403c" title="Enable interrupts globally.">cpu_irq_enable</a>();
    }
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__os__port__group_ga3950e19158970000b838014a821fa8d8_cgraph.gif" border="0" usemap="#group__os__port__group_ga3950e19158970000b838014a821fa8d8_cgraph" alt=""/></div>
<map name="group__os__port__group_ga3950e19158970000b838014a821fa8d8_cgraph" id="group__os__port__group_ga3950e19158970000b838014a821fa8d8_cgraph">
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gab74d8096f9ac6e91cac465212f953f5f"></a><!-- doxytag: member="os_core.h::os_switch_context_hook" ref="gab74d8096f9ac6e91cac465212f953f5f" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structos__process.html">os_process</a>* os_switch_context_hook </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This function must be called inside the <a class="el" href="group__os__port__group.html#gae36200d59d62e81114d9330a2cab31c5">os_switch_context</a> function in order to switch process context. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>The context of the new process </dd></dl>

<p>Definition at line <a class="el" href="os__core_8h_source.html#l00613">613</a> of file <a class="el" href="os__core_8h_source.html">os_core.h</a>.</p>

<p>References <a class="el" href="os__core_8c_source.html#l00051">os_scheduler()</a>, <a class="el" href="os__event_8h_source.html#l00209">OS_SCHEDULER_POST_EVENT_HOOK</a>, and <a class="el" href="os__interrupt_8h_source.html#l00167">OS_SCHEDULER_POST_INTERRUPT_HOOK</a>.</p>

<p>Referenced by <a class="el" href="uc3__port_8c_source.html#l00196">_os_switch_context()</a>.</p>
<div class="fragment"><pre class="fragment">                                                              {
<span class="preprocessor">#ifdef OS_SCHEDULER_POST_INTERRUPT_HOOK</span>
<span class="preprocessor"></span>    <span class="comment">// Clear the software interrupt if needed</span>
    <a class="code" href="os__interrupt_8h.html#a0a55e3754e380e60d0a7d8eeb7f35b76">OS_SCHEDULER_POST_INTERRUPT_HOOK</a>();
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span><span class="preprocessor">#ifdef OS_SCHEDULER_POST_EVENT_HOOK</span>
<span class="preprocessor"></span>    <span class="comment">// Use the alternate task if any</span>
    <a class="code" href="os__event_8h.html#aa255476daa235b6c1a7191327005768e">OS_SCHEDULER_POST_EVENT_HOOK</a>();
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>    <span class="comment">// Task switch context</span>
    <span class="keywordflow">return</span> <a class="code" href="os__core_8c.html#a20076b02ccddcff5a14e46779c909b7b" title="This function will define the rules to change the task.">os_scheduler</a>();
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__os__port__group_gab74d8096f9ac6e91cac465212f953f5f_cgraph.gif" border="0" usemap="#group__os__port__group_gab74d8096f9ac6e91cac465212f953f5f_cgraph" alt=""/></div>
<map name="group__os__port__group_gab74d8096f9ac6e91cac465212f953f5f_cgraph" id="group__os__port__group_gab74d8096f9ac6e91cac465212f953f5f_cgraph">
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga190ac35a6514e5abd07f888ac794e541"></a><!-- doxytag: member="uc3_port.c::os_switch_context_int_handler" ref="ga190ac35a6514e5abd07f888ac794e541" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">os_switch_context_int_handler </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Context switch for a process.<br/>
 Interrupt handler which is used to schedule and switch between the processes. </p>

<p>Referenced by <a class="el" href="uc3__port_8c_source.html#l00037">os_setup_scheduler()</a>.</p>

</div>
</div>
<a class="anchor" id="gace899bdd3da9a10327e10f93ec79c49a"></a><!-- doxytag: member="os_core.h::os_switch_context_int_handler_hook" ref="gace899bdd3da9a10327e10f93ec79c49a" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structos__process.html">os_process</a>* os_switch_context_int_handler_hook </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This function must be called inside the <a class="el" href="group__os__port__group.html#ga190ac35a6514e5abd07f888ac794e541">os_switch_context_int_handler</a> function in order to switch task context. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>The context of the new process </dd></dl>

<p>Definition at line <a class="el" href="os__core_8h_source.html#l00594">594</a> of file <a class="el" href="os__core_8h_source.html">os_core.h</a>.</p>

<p>References <a class="el" href="os__debug_8h_source.html#l00046">HOOK_OS_DEBUG_TICK</a>, <a class="el" href="os__core_8h_source.html#l00226">HOOK_OS_TICK</a>, <a class="el" href="os__core_8c_source.html#l00051">os_scheduler()</a>, and <a class="el" href="os__core_8c_source.html#l00047">tick_counter</a>.</p>

<p>Referenced by <a class="el" href="uc3__port_8c_source.html#l00150">ISR()</a>.</p>
<div class="fragment"><pre class="fragment">                                                                          {
<span class="preprocessor">#if CONFIG_OS_USE_TICK_COUNTER == true</span>
<span class="preprocessor"></span>    <span class="keyword">extern</span> <span class="keyword">volatile</span> <a class="code" href="os__core_8h.html#a38ef3fb720f7928704ee6e16452ff26e" title="Type to define a number of ticks.">os_tick_t</a> <a class="code" href="os__core_8c.html#ad4c76cdc3ec21a192769c94765993d05" title="Tick counter.">tick_counter</a>;
    <span class="comment">// Update the tick counter</span>
    tick_counter++;
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span><span class="preprocessor">#if CONFIG_OS_DEBUG == true</span>
<span class="preprocessor"></span>    <a class="code" href="os__debug_8h.html#a17cc700ec6f82440b7c77ec923aed135">HOOK_OS_DEBUG_TICK</a>();
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>    <a class="code" href="group__os__hook.html#gaef881832ec0e5952730571c89fae6616" title="This hook is called during each tick interrupt.">HOOK_OS_TICK</a>();
    <span class="comment">// Task switch context</span>
    <span class="keywordflow">return</span> <a class="code" href="os__core_8c.html#a20076b02ccddcff5a14e46779c909b7b" title="This function will define the rules to change the task.">os_scheduler</a>();
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__os__port__group_gace899bdd3da9a10327e10f93ec79c49a_cgraph.gif" border="0" usemap="#group__os__port__group_gace899bdd3da9a10327e10f93ec79c49a_cgraph" alt=""/></div>
<map name="group__os__port__group_gace899bdd3da9a10327e10f93ec79c49a_cgraph" id="group__os__port__group_gace899bdd3da9a10327e10f93ec79c49a_cgraph">
</map>
</div>
</p>

</div>
</div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Thu Dec 15 2011 13:05:49 for OS by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
